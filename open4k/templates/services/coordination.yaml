#apiVersion: lcm.mirantis.com/v1alpha1
#kind: HelmBundle

spec:
  releases:
  - name: etcd
    chart: {{spec.common.infra.repo}}/etcd
    values:
      images:
        tags:
{%- for image in [
    "etcd",
    "etcd_db_compact",
    "dep_check",
    "image_repo_sync",] %}
        {%- if image in images %}
          {{ image }}: {{ images[image] }}
        {%- endif %}
{%- endfor %}
      manifests:
        cron_job_db_compact: true
      endpoints:
        cluster_domain_suffix: {{ spec.internal_domain_name }}
      pod:
        replicas:
          etcd: 3
      volume:
        class_name: {{ spec.get('local_volume_storage_class', 'lvp-fake-root') }}

